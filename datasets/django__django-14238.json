{
  "instance_id": "django__django-14238",
  "problem_statement": "DEFAULT_AUTO_FIELD subclass check fails for subclasses of BigAutoField and SmallAutoField.\nDescription\n\t\nSet DEFAULT_AUTO_FIELD = \"example.core.models.MyBigAutoField\" , with contents of example.core.models:\nfrom django.db import models\nclass MyBigAutoField(models.BigAutoField):\n\tpass\nclass MyModel(models.Model):\n\tpass\nDjango then crashes with:\nTraceback (most recent call last):\n File \"/..././manage.py\", line 21, in <module>\n\tmain()\n File \"/..././manage.py\", line 17, in main\n\texecute_from_command_line(sys.argv)\n File \"/.../venv/lib/python3.9/site-packages/django/core/management/__init__.py\", line 419, in execute_from_command_line\n\tutility.execute()\n File \"/.../venv/lib/python3.9/site-packages/django/core/management/__init__.py\", line 395, in execute\n\tdjango.setup()\n File \"/.../venv/lib/python3.9/site-packages/django/__init__.py\", line 24, in setup\n\tapps.populate(settings.INSTALLED_APPS)\n File \"/.../venv/lib/python3.9/site-packages/django/apps/registry.py\", line 114, in populate\n\tapp_config.import_models()\n File \"/.../venv/lib/python3.9/site-packages/django/apps/config.py\", line 301, in import_models\n\tself.models_module = import_module(models_module_name)\n File \"/Users/chainz/.pyenv/versions/3.9.1/lib/python3.9/importlib/__init__.py\", line 127, in import_module\n\treturn _bootstrap._gcd_import(name[level:], package, level)\n File \"<frozen importlib._bootstrap>\", line 1030, in _gcd_import\n File \"<frozen importlib._bootstrap>\", line 1007, in _find_and_load\n File \"<frozen importlib._bootstrap>\", line 986, in _find_and_load_unlocked\n File \"<frozen importlib._bootstrap>\", line 680, in _load_unlocked\n File \"<frozen importlib._bootstrap_external>\", line 790, in exec_module\n File \"<frozen importlib._bootstrap>\", line 228, in _call_with_frames_removed\n File \"/.../example/core/models.py\", line 8, in <module>\n\tclass MyModel(models.Model):\n File \"/.../venv/lib/python3.9/site-packages/django/db/models/base.py\", line 320, in __new__\n\tnew_class._prepare()\n File \"/.../venv/lib/python3.9/site-packages/django/db/models/base.py\", line 333, in _prepare\n\topts._prepare(cls)\n File \"/.../venv/lib/python3.9/site-packages/django/db/models/options.py\", line 285, in _prepare\n\tpk_class = self._get_default_pk_class()\n File \"/.../venv/lib/python3.9/site-packages/django/db/models/options.py\", line 246, in _get_default_pk_class\n\traise ValueError(\nValueError: Primary key 'example.core.models.MyBigAutoField' referred by DEFAULT_AUTO_FIELD must subclass AutoField.\nThis can be fixed in AutoFieldMeta.__subclasscheck__ by allowing subclasses of those classes in the _subclasses property.\n",
  "localized_code": "[start of django/db/models/fields/__init__.py]\n1: import collections.abc\n2: import copy\n3: import datetime\n4: import decimal\n5: import operator\n6: import uuid\n7: import warnings\n8: from base64 import b64decode, b64encode\n9: from functools import partialmethod, total_ordering\n10: \n11: from django import forms\n12: from django.apps import apps\n13: from django.conf import settings\n14: from django.core import checks, exceptions, validators\n15: from django.db import connection, connections, router\n16: from django.db.models.constants import LOOKUP_SEP\n17: from django.db.models.query_utils import DeferredAttribute, RegisterLookupMixin\n18: from django.utils import timezone\n19: from django.utils.datastructures import DictWrapper\n20: from django.utils.dateparse import (\n21:     parse_date, parse_datetime, parse_duration, parse_time,\n22: )\n23: from django.utils.duration import duration_microseconds, duration_string\n24: from django.utils.functional import Promise, cached_property\n25: from django.utils.ipv6 import clean_ipv6_address\n26: from django.utils.itercompat import is_iterable\n27: from django.utils.text import capfirst\n28: from django.utils.translation import gettext_lazy as _\n29: \n30: __all__ = [\n31:     'AutoField', 'BLANK_CHOICE_DASH', 'BigAutoField', 'BigIntegerField',\n32:     'BinaryField', 'BooleanField', 'CharField', 'CommaSeparatedIntegerField',\n33:     'DateField', 'DateTimeField', 'DecimalField', 'DurationField',\n34:     'EmailField', 'Empty', 'Field', 'FilePathField', 'FloatField',\n35:     'GenericIPAddressField', 'IPAddressField', 'IntegerField', 'NOT_PROVIDED',\n36:     'NullBooleanField', 'PositiveBigIntegerField', 'PositiveIntegerField',\n37:     'PositiveSmallIntegerField', 'SlugField', 'SmallAutoField',\n38:     'SmallIntegerField', 'TextField', 'TimeField', 'URLField', 'UUIDField',\n39: ]\n40: \n41: \n42: class Empty:\n43:     pass\n44: \n45: \n46: class NOT_PROVIDED:\n47:     pass\n48: \n49: \n50: # The values to use for \"blank\" in SelectFields. Will be appended to the start\n51: # of most \"choices\" lists.\n52: BLANK_CHOICE_DASH = [(\"\", \"---------\")]\n53: \n54: \n55: def _load_field(app_label, model_name, field_name):\nCode replaced for brevity.\n56: \n57: \n58: \n59: # A guide to Field parameters:\n60: #\n61: #   * name:      The name of the field specified in the model.\n62: #   * attname:   The attribute to use on the model object. This is the same as\n63: #                \"name\", except in the case of ForeignKeys, where \"_id\" is\n64: #                appended.\n65: #   * db_column: The db_column specified in the model (or None).\n66: #   * column:    The database column for this field. This is the same as\n67: #                \"attname\", except if db_column is specified.\n68: #\n69: # Code that introspects values, or does other dynamic things, should use\n70: # attname. For example, this gets the primary key value of object \"obj\":\n71: #\n72: #     getattr(obj, opts.pk.attname)\n73: \n74: def _empty(of_cls):\n75:     new = Empty()\n76:     new.__class__ = of_cls\n77:     return new\n78: \n79: \n80: def return_None():\n81:     return None\n82: \n83: \n84: @total_ordering\n85: class Field(RegisterLookupMixin):\nCode replaced for brevity.\n952: \n953: \n954: \n955: class BooleanField(Field):\nCode replaced for brevity.\n998: \n999: \n1000: \n1001:     descript\nCode replaced for brevity.\n1091: \n1092: \n1093: \n1094:     default_\nCode replaced for brevity.\n1107: \n1108: \n1109: \n1110:     def chec\nCode replaced for brevity.\n1139: \n1140: \n1141: \n1142:     empty_st\nCode replaced for brevity.\n1282: \n1283: \n1284: \n1285:     empty_strings_al\nCode replaced for brevity.\n1438: \n1439: \n1440: \n1441: empty_strings_allowed = Fals\nCode replaced for brevity.\n1573: \n1574: \n1575: \n1576:     Store timedelta objects.\nCode replaced for brevity.\n1633: \n1634: \n1635: \n1636: ault_validators = [validators.val\nCode replaced for brevity.\n1657: \n1658: \n1659: \n1660:     de\nCode replaced for brevity.\n1721: \n1722: \n1723: \n1724:     de\nCode replaced for brevity.\n1761: \n1762: \n1763: \n1764:     defaul\nCode replaced for brevity.\n1848: \n1849: \n1850: \n1851: cription = _(\"Big (8 byte) integer\")\nCode replaced for brevity.\n1863: \n1864: \n1865: \n1866:     def ge\nCode replaced for brevity.\n1870: \n1871: \n1872: \n1873:     descriptio\nCode replaced for brevity.\n1901: \n1902: \n1903: \n1904:     descriptio\nCode replaced for brevity.\n1981: \n1982: \n1983: \n1984:         'invalid'\nCode replaced for brevity.\n2011: \n2012: \n2013: \n2014:         super(\nCode replaced for brevity.\n2039: \n2040: \n2041: \n2042:     def get\nCode replaced for brevity.\n2052: \n2053: \n2054: \n2055:     def get_int\nCode replaced for brevity.\n2065: \n2066: \n2067: \n2068:     def g\nCode replaced for brevity.\n2078: \n2079: \n2080: \n2081: [validators.validate_slug]\nCode replaced for brevity.\n2111: \n2112: \n2113: \n2114: def __init__(self, *arg\nCode replaced for brevity.\n2175: \n2176: \n2177: \n2178:     default_error_mess\nCode replaced for brevity.\n2307: \n2308: \n2309: \n2310:     descrip\nCode replaced for brevity.\n2330: \n2331: \n2332: \n2333:     empty_values = [None,\nCode replaced for brevity.\n2394: \n2395: \n2396: \n2397: 'invalid': _('“%(value)s”\nCode replaced for brevity.\n2447: \n2448: \n2449: \n2450: self, *args, **kwargs):\nCode replaced for brevity.\n2499: \n2500: \n2501: \n2502: class AutoFieldMeta(type):\n2503:     \"\"\"\n2504:     Metaclass to maintain backward inheritance compatibility for AutoField.\n2505: \n2506:     It is intended that AutoFieldMixin become public API when it is possible to\n2507:     create a non-integer automatically-generated field using column defaults\n2508:     stored in the database.\n2509: \n2510:     In many areas Django also relies on using isinstance() to check for an\n2511:     automatically-generated field as a subclass of AutoField. A new flag needs\n2512:     to be implemented on Field to be used instead.\n2513: \n2514:     When these issues have been addressed, this metaclass could be used to\n2515:     deprecate inheritance from AutoField and use of isinstance() with AutoField\n2516:     for detecting automatically-generated fields.\n2517:     \"\"\"\n2518: \n2519:     @property\n2520:     def _subclasses(self):\n2521:         return (BigAutoField, SmallAutoField)\n2522: \n2523:     def __instancecheck__(self, instance):\n2524:         return isinstance(instance, self._subclasses) or super().__instancecheck__(instance)\n2525: \n2526:     def __subclasscheck__(self, subclass):\n2527:         return subclass in self._subclasses or super().__subclasscheck__(subclass)\n2528: \n2529: \n2530:     def\nCode replaced for brevity.\n2536: \n2537: \n2538: \n2539:         return 'BigAutoField'\nCode replaced for brevity.\n2545: \n2546: \n2547: \n2548:         return 'SmallAutoField'\nCode replaced for brevity.\n2554: \n\n",
  "line_level_localization": [
    {
      "filename": "/django/db/models/fields/__init__.py",
      "suspect_lines": [
        2527
      ]
    }
  ]
}
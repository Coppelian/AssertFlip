{
  "instance_id": "django__django-14373",
  "problem_statement": "DateFormat.Y() is not zero-padded.\nDescription\n\t\nThe Y specifier for django.utils.dateformat.DateFormat is supposed to always return a four-digit year padded with zeros. This doesn't seem to be the case for year < 1000.\n",
  "localized_code": "[start of django/utils/dateformat.py]\n1: \"\"\"\n2: PHP date() style date formatting\n3: See http://www.php.net/date for format strings\n4: \n5: Usage:\n6: >>> import datetime\n7: >>> d = datetime.datetime.now()\n8: >>> df = DateFormat(d)\n9: >>> print(df.format('jS F Y H:i'))\n10: 7th October 2003 11:39\n11: >>>\n12: \"\"\"\n13: import calendar\n14: import datetime\n15: import time\n16: from email.utils import format_datetime as format_datetime_rfc5322\n17: \n18: from django.utils.dates import (\n19:     MONTHS, MONTHS_3, MONTHS_ALT, MONTHS_AP, WEEKDAYS, WEEKDAYS_ABBR,\n20: )\n21: from django.utils.regex_helper import _lazy_re_compile\n22: from django.utils.timezone import (\n23:     _datetime_ambiguous_or_imaginary, get_default_timezone, is_aware, is_naive,\n24:     make_aware,\n25: )\n26: from django.utils.translation import gettext as _\n27: \n28: re_formatchars = _lazy_re_compile(r'(?<!\\\\)([aAbcdDeEfFgGhHiIjlLmMnNoOPrsStTUuwWyYzZ])')\n29: re_escaped = _lazy_re_compile(r'\\\\(.)')\n30: \n31: \n32: class Formatter:\n33:     def format(self, formatstr):\n34:         pieces = []\n35:         for i, piece in enumerate(re_formatchars.split(str(formatstr))):\n36:             if i % 2:\n37:                 if type(self.data) is datetime.date and hasattr(TimeFormat, piece):\n38:                     raise TypeError(\n39:                         \"The format for date objects may not contain \"\n40:                         \"time-related format specifiers (found '%s').\" % piece\n41:                     )\n42:                 pieces.append(str(getattr(self, piece)()))\n43:             elif piece:\n44:                 pieces.append(re_escaped.sub(r'\\1', piece))\n45:         return ''.join(pieces)\n46: \n47: \n48: class TimeFormat(Formatter):\n49: \n50:     def __init__(self, obj):\n51:         self.data = obj\n52:         self.timezone = None\n53: \n54:         # We only support timezone when formatting datetime objects,\n55:         # not date objects (timezone information not appropriate),\n56:         # or time objects (against established django policy).\n57:         if isinstance(obj, datetime.datetime):\n58:             if is_naive(obj):\n59:                 self.timezone = get_default_timezone()\n60:             else:\n61:                 self.timezone = obj.tzinfo\n62: \n63:     def a(self):\n64:         \"'a.m.' or 'p.m.'\"\n65:         if self.data.hour > 11:\n66:             return _('p.m.')\n67:         return _('a.m.')\n68: \n69:     def A(self):\n70:         \"'AM' or 'PM'\"\n71:         if self.data.hour > 11:\n72:             return _('PM')\n73:         return _('AM')\n74: \n75:     def e(self):\n76:         \"\"\"\n77:         Timezone name.\n78: \n79:         If timezone information is not available, return an empty string.\n80:         \"\"\"\n81:         if not self.timezone:\n82:             return \"\"\n83: \n84:         try:\n85:             if hasattr(self.data, 'tzinfo') and self.data.tzinfo:\n86:                 return self.data.tzname() or ''\n87:         except NotImplementedError:\n88:             pass\n89:         return \"\"\n90: \n91:     def f(self):\n92:         \"\"\"\n93:         Time, in 12-hour hours and minutes, with minutes left off if they're\n94:         zero.\n95:         Examples: '1', '1:30', '2:05', '2'\n96:         Proprietary extension.\n97:         \"\"\"\n98:         if self.data.minute == 0:\n99:             return self.g()\n100:         return '%s:%s' % (self.g(), self.i())\n101: \n102:     def g(self):\n103:         \"Hour, 12-hour format without leading zeros; i.e. '1' to '12'\"\n104:         return self.data.hour % 12 or 12\n105: \n106:     def G(self):\n107:         \"Hour, 24-hour format without leading zeros; i.e. '0' to '23'\"\n108:         return self.data.hour\n109: \n110:     def h(self):\n111:         \"Hour, 12-hour format; i.e. '01' to '12'\"\n112:         return '%02d' % self.g()\n113: \n114:     def H(self):\n115:         \"Hour, 24-hour format; i.e. '00' to '23'\"\n116:         return '%02d' % self.G()\n117: \n118:     def i(self):\n119:         \"Minutes; i.e. '00' to '59'\"\n120:         return '%02d' % self.data.minute\n121: \n122:     def O(self):  # NOQA: E743, E741\n123:         \"\"\"\n124:         Difference to Greenwich time in hours; e.g. '+0200', '-0430'.\n125: \n126:         If timezone information is not available, return an empty string.\n127:         \"\"\"\n128:         if not self.timezone:\n129:             return \"\"\n130: \n131:         seconds = self.Z()\n132:         if seconds == \"\":\n133:             return \"\"\n134:         sign = '-' if seconds < 0 else '+'\n135:         seconds = abs(seconds)\n136:         return \"%s%02d%02d\" % (sign, seconds // 3600, (seconds // 60) % 60)\n137: \n138:     def P(self):\n139:         \"\"\"\n140:         Time, in 12-hour hours, minutes and 'a.m.'/'p.m.', with minutes left off\n141:         if they're zero and the strings 'midnight' and 'noon' if appropriate.\n142:         Examples: '1 a.m.', '1:30 p.m.', 'midnight', 'noon', '12:30 p.m.'\n143:         Proprietary extension.\n144:         \"\"\"\n145:         if self.data.minute == 0 and self.data.hour == 0:\n146:             return _('midnight')\n147:         if self.data.minute == 0 and self.data.hour == 12:\n148:             return _('noon')\n149:         return '%s %s' % (self.f(), self.a())\n150: \n151:     def s(self):\n152:         \"Seconds; i.e. '00' to '59'\"\n153:         return '%02d' % self.data.second\n154: \n155:     def T(self):\n156:         \"\"\"\n157:         Time zone of this machine; e.g. 'EST' or 'MDT'.\n158: \n159:         If timezone information is not available, return an empty string.\n160:         \"\"\"\n161:         if not self.timezone:\n162:             return \"\"\n163: \n164:         if not _datetime_ambiguous_or_imaginary(self.data, self.timezone):\n165:             name = self.timezone.tzname(self.data)\n166:         else:\n167:             name = self.format('O')\n168:         return str(name)\n169: \n170:     def u(self):\n171:         \"Microseconds; i.e. '000000' to '999999'\"\n172:         return '%06d' % self.data.microsecond\n173: \n174:     def Z(self):\n175:         \"\"\"\n176:         Time zone offset in seconds (i.e. '-43200' to '43200'). The offset for\n177:         timezones west of UTC is always negative, and for those east of UTC is\n178:         always positive.\n179: \n180:         If timezone information is not available, return an empty string.\n181:         \"\"\"\n182:         if (\n183:             not self.timezone or\n184:             _datetime_ambiguous_or_imaginary(self.data, self.timezone)\n185:         ):\n186:             return \"\"\n187: \n188:         offset = self.timezone.utcoffset(self.data)\n189: \n190:         # `offset` is a datetime.timedelta. For negative values (to the west of\n191:         # UTC) only days can be negative (days=-1) and seconds are always\n192:         # positive. e.g. UTC-1 -> timedelta(days=-1, seconds=82800, microseconds=0)\n193:         # Positive offsets have days=0\n194:         return offset.days * 86400 + offset.seconds\n195: \n196: \n197: class DateFormat(TimeFormat):\n198:     def b(self):\n199:         \"Month, textual, 3 letters, lowercase; e.g. 'jan'\"\n200:         return MONTHS_3[self.data.month]\n201: \n202:     def c(self):\n203:         \"\"\"\n204:         ISO 8601 Format\n205:         Example : '2008-01-02T10:30:00.000123'\n206:         \"\"\"\n207:         return self.data.isoformat()\n208: \n209:     def d(self):\n210:         \"Day of the month, 2 digits with leading zeros; i.e. '01' to '31'\"\n211:         return '%02d' % self.data.day\n212: \n213:     def D(self):\n214:         \"Day of the week, textual, 3 letters; e.g. 'Fri'\"\n215:         return WEEKDAYS_ABBR[self.data.weekday()]\n216: \n217:     def E(self):\n218:         \"Alternative month names as required by some locales. Proprietary extension.\"\n219:         return MONTHS_ALT[self.data.month]\n220: \n221:     def F(self):\n222:         \"Month, textual, long; e.g. 'January'\"\n223:         return MONTHS[self.data.month]\n224: \n225:     def I(self):  # NOQA: E743, E741\n226:         \"'1' if Daylight Savings Time, '0' otherwise.\"\n227:         if (\n228:             not self.timezone or\n229:             _datetime_ambiguous_or_imaginary(self.data, self.timezone)\n230:         ):\n231:             return ''\n232:         return '1' if self.timezone.dst(self.data) else '0'\n233: \n234:     def j(self):\n235:         \"Day of the month without leading zeros; i.e. '1' to '31'\"\n236:         return self.data.day\n237: \n238:     def l(self):  # NOQA: E743, E741\n239:         \"Day of the week, textual, long; e.g. 'Friday'\"\n240:         return WEEKDAYS[self.data.weekday()]\n241: \n242:     def L(self):\n243:         \"Boolean for whether it is a leap year; i.e. True or False\"\n244:         return calendar.isleap(self.data.year)\n245: \n246:     def m(self):\n247:         \"Month; i.e. '01' to '12'\"\n248:         return '%02d' % self.data.month\n249: \n250:     def M(self):\n251:         \"Month, textual, 3 letters; e.g. 'Jan'\"\n252:         return MONTHS_3[self.data.month].title()\n253: \n254:     def n(self):\n255:         \"Month without leading zeros; i.e. '1' to '12'\"\n256:         return self.data.month\n257: \n258:     def N(self):\n259:         \"Month abbreviation in Associated Press style. Proprietary extension.\"\n260:         return MONTHS_AP[self.data.month]\n261: \n262:     def o(self):\n263:         \"ISO 8601 year number matching the ISO week number (W)\"\n264:         return self.data.isocalendar()[0]\n265: \n266:     def r(self):\n267:         \"RFC 5322 formatted date; e.g. 'Thu, 21 Dec 2000 16:01:07 +0200'\"\n268:         if type(self.data) is datetime.date:\n269:             raise TypeError(\n270:                 \"The format for date objects may not contain time-related \"\n271:                 \"format specifiers (found 'r').\"\n272:             )\n273:         if is_naive(self.data):\n274:             dt = make_aware(self.data, timezone=self.timezone)\n275:         else:\n276:             dt = self.data\n277:         return format_datetime_rfc5322(dt)\n278: \n279:     def S(self):\n280:         \"English ordinal suffix for the day of the month, 2 characters; i.e. 'st', 'nd', 'rd' or 'th'\"\n281:         if self.data.day in (11, 12, 13):  # Special case\n282:             return 'th'\n283:         last = self.data.day % 10\n284:         if last == 1:\n285:             return 'st'\n286:         if last == 2:\n287:             return 'nd'\n288:         if last == 3:\n289:             return 'rd'\n290:         return 'th'\n291: \n292:     def t(self):\n293:         \"Number of days in the given month; i.e. '28' to '31'\"\n294:         return '%02d' % calendar.monthrange(self.data.year, self.data.month)[1]\n295: \n296:     def U(self):\n297:         \"Seconds since the Unix epoch (January 1 1970 00:00:00 GMT)\"\n298:         if isinstance(self.data, datetime.datetime) and is_aware(self.data):\n299:             return int(calendar.timegm(self.data.utctimetuple()))\n300:         else:\n301:             return int(time.mktime(self.data.timetuple()))\n302: \n303:     def w(self):\n304:         \"Day of the week, numeric, i.e. '0' (Sunday) to '6' (Saturday)\"\n305:         return (self.data.weekday() + 1) % 7\n306: \n307:     def W(self):\n308:         \"ISO-8601 week number of year, weeks starting on Monday\"\n309:         return self.data.isocalendar()[1]\n310: \n311:     def y(self):\n312:         \"\"\"Year, 2 digits with leading zeros; e.g. '99'.\"\"\"\n313:         return '%02d' % (self.data.year % 100)\n314: \n315:     def Y(self):\n316:         \"Year, 4 digits; e.g. '1999'\"\n317:         return self.data.year\n318: \n... Code Truncated ...\n\n",
  "line_level_localization": [
    {
      "filename": "/django/utils/dateformat.py",
      "suspect_lines": [
        316,
        317
      ]
    }
  ]
}
{
  "instance_id": "django__django-15569",
  "problem_statement": "RegisterLookupMixin._unregister_lookup() should clear the lookup cache.\nDescription\n\t \n\t\t(last modified by Himanshu Balasamanta)\n\t \nIn current source code, in the _unregister_lookup method, ​https://github.com/django/django/blame/main/django/db/models/query_utils.py#L212, the cache is not cleared, which should be done, as it is done in register_lookup, ​https://github.com/django/django/blame/main/django/db/models/query_utils.py#L202. Corresponding to this change, minor changes need to be brought in the schema.tests.SchemaTests.test_func_unique_constraint_lookups test.\nThe PR generated is ​https://github.com/django/django/pull/15569\n",
  "localized_code": "[start of django/db/models/query_utils.py]\n1: \"\"\"\n2: Various data structures used in query construction.\n3: \n4: Factored out from django.db.models.query to avoid making the main module very\n5: large and/or so that they can be used by other modules without getting into\n6: circular import difficulties.\n7: \"\"\"\n8: import copy\n9: import functools\n10: import inspect\n11: from collections import namedtuple\n12: \n13: from django.core.exceptions import FieldError\n14: from django.db.models.constants import LOOKUP_SEP\n15: from django.utils import tree\n16: \n17: # PathInfo is used when converting lookups (fk__somecol). The contents\n18: # describe the relation in Model terms (model Options and Fields for both\n19: # sides of the relation. The join_field is the field backing the relation.\n20: PathInfo = namedtuple(\n21:     \"PathInfo\",\n22:     \"from_opts to_opts target_fields join_field m2m direct filtered_relation\",\n23: )\n24: \n25: \n26: def subclasses(cls):\n27:     yield cls\n28:     for subclass in cls.__subclasses__():\n29:         yield from subclasses(subclass)\n30: \n31: \n32: class Q(tree.Node):\n33:     \"\"\"\n34:     Encapsulate filters as objects that can then be combined logically (using\n35:     `&` and `|`).\n36:     \"\"\"\n37: \n38:     # Connection types\n39:     AND = \"AND\"\n40:     OR = \"OR\"\n41:     XOR = \"XOR\"\n42:     default = AND\n43:     conditional = True\n44: \n45:     def __init__(self, *args, _connector=None, _negated=False, **kwargs):\n46:         super().__init__(\n47:             children=[*args, *sorted(kwargs.items())],\n48:             connector=_connector,\n49:             negated=_negated,\n50:         )\n51: \n... Code Truncated ...\n\n",
  "line_level_localization": [
    {
      "filename": "/django/db/models/query_utils.py",
      "suspect_lines": []
    }
  ]
}
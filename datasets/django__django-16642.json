{
  "instance_id": "django__django-16642",
  "problem_statement": "Improper guessing of Mime Type for \"br\" and \"Z\" file types\nDescription\n\t\nBelow FileResponse will set the content type as text/html, even if the last file extension is \"Z' or \"br\".\nFileResponse(open('test.html.Z', 'rb'))\nFileResponse(open('test.html.br', 'rb'))\n",
  "localized_code": "[start of django/http/response.py]\n1: import datetime\n2: import io\n3: import json\n4: import mimetypes\n5: import os\n6: import re\n7: import sys\n8: import time\n9: import warnings\n10: from email.header import Header\n11: from http.client import responses\n12: from urllib.parse import urlparse\n13: \n14: from asgiref.sync import async_to_sync, sync_to_async\n15: \n16: from django.conf import settings\n17: from django.core import signals, signing\n18: from django.core.exceptions import DisallowedRedirect\n19: from django.core.serializers.json import DjangoJSONEncoder\n20: from django.http.cookie import SimpleCookie\n21: from django.utils import timezone\n22: from django.utils.datastructures import CaseInsensitiveMapping\n23: from django.utils.encoding import iri_to_uri\n24: from django.utils.http import content_disposition_header, http_date\n25: from django.utils.regex_helper import _lazy_re_compile\n26: \n27: _charset_from_content_type_re = _lazy_re_compile(\n28:     r\";\\s*charset=(?P<charset>[^\\s;]+)\", re.I\n29: )\n30: \n31: \n32: class ResponseHeaders(CaseInsensitiveMapping):\n33:     def __init__(self, data):\n34:         \"\"\"\n35:         Populate the initial data using __setitem__ to ensure values are\n36:         correctly encoded.\n37:         \"\"\"\n38:         self._store = {}\n39:         if data:\n40:             for header, value in self._unpack_items(data):\n41:                 self[header] = value\n42: \n43:     def _convert_to_charset(self, value, charset, mime_encode=False):\n44:         \"\"\"\n45:         Convert headers key/value to ascii/latin-1 native strings.\n46:         `charset` must be 'ascii' or 'latin-1'. If `mime_encode` is True and\n47:         `value` can't be represented in the given charset, apply MIME-encoding.\n48:         \"\"\"\n49:         try:\n50:             if isinstance(value, str):\n51:                 # Ensure string is valid in given charset\n... Code Truncated ...\n\n",
  "line_level_localization": [
    {
      "filename": "/django/http/response.py",
      "suspect_lines": []
    }
  ]
}
{
  "instance_id": "pylint-dev__pylint-6386",
  "problem_statement": "Argument expected for short verbose option\n### Bug description\r\n\r\nThe short option of the `verbose` option expects an argument.\r\nAlso, the help message for the `verbose` option suggests a value `VERBOSE` should be provided.\r\n\r\nThe long option works ok & doesn't expect an argument:\r\n`pylint mytest.py --verbose`\r\n\r\n\r\n### Command used\r\n\r\n```shell\r\npylint mytest.py -v\r\n```\r\n\r\n\r\n### Pylint output\r\n\r\n```shell\r\nusage: pylint [options]\r\npylint: error: argument --verbose/-v: expected one argument\r\n```\r\n\r\n### Expected behavior\r\n\r\nSimilar behaviour to the long option.\r\n\r\n### Pylint version\r\n\r\n```shell\r\npylint 2.14.0-dev0\r\nastroid 2.11.2\r\nPython 3.10.0b2 (v3.10.0b2:317314165a, May 31 2021, 10:02:22) [Clang 12.0.5 (clang-1205.0.22.9)]\r\n```\r\n\n",
  "localized_code": "[start of pylint/config/argument.py]\n1: # Licensed under the GPL: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html\n2: # For details: https://github.com/PyCQA/pylint/blob/main/LICENSE\n3: # Copyright (c) https://github.com/PyCQA/pylint/blob/main/CONTRIBUTORS.txt\n4: \n5: \"\"\"Definition of an Argument class and transformers for various argument types.\n6: \n7: An Argument instance represents a pylint option to be handled by an argparse.ArgumentParser\n8: \"\"\"\n9: \n10: from __future__ import annotations\n11: \n12: import argparse\n13: import pathlib\n14: import re\n15: import sys\n16: from collections.abc import Callable\n17: from typing import Any, Pattern, Sequence, Tuple, Union\n18: \n19: from pylint import interfaces\n20: from pylint import utils as pylint_utils\n21: from pylint.config.callback_actions import _CallbackAction, _ExtendAction\n22: from pylint.config.deprecation_actions import _NewNamesAction, _OldNamesAction\n23: from pylint.constants import PY38_PLUS\n24: \n25: if sys.version_info >= (3, 8):\n26:     from typing import Literal\n27: else:\n28:     from typing_extensions import Literal\n29: \n30: \n31: _ArgumentTypes = Union[\n32:     str,\n33:     int,\n34:     float,\n35:     bool,\n36:     Pattern[str],\n37:     Sequence[str],\n38:     Sequence[Pattern[str]],\n39:     Tuple[int, ...],\n40: ]\n41: \"\"\"List of possible argument types.\"\"\"\n42: \n43: \n44: def _confidence_transformer(value: str) -> Sequence[str]:\n45:     \"\"\"Transforms a comma separated string of confidence values.\"\"\"\n46:     values = pylint_utils._check_csv(value)\n47:     for confidence in values:\n48:         if confidence not in interfaces.CONFIDENCE_LEVEL_NAMES:\n49:             raise argparse.ArgumentTypeError(\n50:                 f\"{value} should be in {*interfaces.CONFIDENCE_LEVEL_NAMES,}\"\n51:             )\n... Code Truncated ...\n\n[start of pylint/config/arguments_manager.py]\n1: # Licensed under the GPL: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html\n2: # For details: https://github.com/PyCQA/pylint/blob/main/LICENSE\n3: # Copyright (c) https://github.com/PyCQA/pylint/blob/main/CONTRIBUTORS.txt\n4: \n5: \"\"\"Arguments manager class used to handle command-line arguments and options.\"\"\"\n6: \n7: from __future__ import annotations\n8: \n9: import argparse\n10: import configparser\n11: import copy\n12: import optparse  # pylint: disable=deprecated-module\n13: import os\n14: import re\n15: import sys\n16: import textwrap\n17: import warnings\n18: from collections import OrderedDict\n19: from collections.abc import Sequence\n20: from pathlib import Path\n21: from typing import TYPE_CHECKING, Any, TextIO, Union\n22: \n23: import tomlkit\n24: \n25: from pylint import utils\n26: from pylint.config.argument import (\n27:     _Argument,\n28:     _CallableArgument,\n29:     _ExtendArgument,\n30:     _StoreArgument,\n31:     _StoreNewNamesArgument,\n32:     _StoreOldNamesArgument,\n33:     _StoreTrueArgument,\n34: )\n35: from pylint.config.exceptions import (\n36:     UnrecognizedArgumentAction,\n37:     _UnrecognizedOptionError,\n38: )\n39: from pylint.config.help_formatter import _HelpFormatter\n40: from pylint.config.option import Option\n41: from pylint.config.option_parser import OptionParser\n42: from pylint.config.options_provider_mixin import OptionsProviderMixIn\n43: from pylint.config.utils import _convert_option_to_argument, _parse_rich_type_value\n44: from pylint.constants import MAIN_CHECKER_NAME\n45: from pylint.typing import OptionDict\n46: \n47: if sys.version_info >= (3, 11):\n48:     import tomllib\n49: else:\n50:     import tomli as tomllib\n51: \n... Code Truncated ...\n\n[start of pylint/config/utils.py]\n1: # Licensed under the GPL: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html\n2: # For details: https://github.com/PyCQA/pylint/blob/main/LICENSE\n3: # Copyright (c) https://github.com/PyCQA/pylint/blob/main/CONTRIBUTORS.txt\n4: \n5: \"\"\"Utils for arguments/options parsing and handling.\"\"\"\n6: \n7: from __future__ import annotations\n8: \n9: import re\n10: import warnings\n11: from collections.abc import Callable, Sequence\n12: from pathlib import Path\n13: from typing import TYPE_CHECKING, Any\n14: \n15: from pylint import extensions, utils\n16: from pylint.config.argument import (\n17:     _CallableArgument,\n18:     _ExtendArgument,\n19:     _StoreArgument,\n20:     _StoreNewNamesArgument,\n21:     _StoreOldNamesArgument,\n22:     _StoreTrueArgument,\n23: )\n24: from pylint.config.callback_actions import _CallbackAction\n25: from pylint.config.exceptions import ArgumentPreprocessingError\n26: \n27: if TYPE_CHECKING:\n28:     from pylint.lint.run import Run\n29: \n30: \n31: def _convert_option_to_argument(\n32:     opt: str, optdict: dict[str, Any]\n33: ) -> (\n34:     _StoreArgument\n35:     | _StoreTrueArgument\n36:     | _CallableArgument\n37:     | _StoreOldNamesArgument\n38:     | _StoreNewNamesArgument\n39:     | _ExtendArgument\n40: ):\n41:     \"\"\"Convert an optdict to an Argument class instance.\"\"\"\n42:     if \"level\" in optdict and \"hide\" not in optdict:\n43:         warnings.warn(\n44:             \"The 'level' key in optdicts has been deprecated. \"\n45:             \"Use 'hide' with a boolean to hide an option from the help message.\",\n46:             DeprecationWarning,\n47:         )\n48: \n49:     # Get the long and short flags\n50:     flags = [f\"--{opt}\"]\n51:     if \"short\" in optdict:\n52:         flags += [f\"-{optdict['short']}\"]\n53: \n54:     # Get the action type\n55:     action = optdict.get(\"action\", \"store\")\n56: \n57:     if action == \"store_true\":\n58:         return _StoreTrueArgument(\n59:             flags=flags,\n60:             action=action,\n61:             default=optdict.get(\"default\", True),\n62:             arg_help=optdict.get(\"help\", \"\"),\n63:             hide_help=optdict.get(\"hide\", False),\n64:             section=optdict.get(\"group\", None),\n65:         )\n66:     if not isinstance(action, str) and issubclass(action, _CallbackAction):\n67:         return _CallableArgument(\n68:             flags=flags,\n69:             action=action,\n70:             arg_help=optdict.get(\"help\", \"\"),\n71:             kwargs=optdict.get(\"kwargs\", {}),\n72:             hide_help=optdict.get(\"hide\", False),\n73:             section=optdict.get(\"group\", None),\n74:         )\n75:     try:\n76:         default = optdict[\"default\"]\n77:     except KeyError:\n78:         warnings.warn(\n79:             \"An option dictionary should have a 'default' key to specify \"\n80:             \"the option's default value. This key will be required in pylint \"\n81:             \"3.0. It is not required for 'store_true' and callable actions.\",\n82:             DeprecationWarning,\n83:         )\n84:         default = None\n85:     if action == \"extend\":\n86:         return _ExtendArgument(\n87:             flags=flags,\n88:             action=action,\n89:             default=default,\n90:             arg_type=optdict[\"type\"],\n91:             choices=optdict.get(\"choices\", None),\n92:             arg_help=optdict.get(\"help\", \"\"),\n93:             metavar=optdict.get(\"metavar\", \"\"),\n94:             hide_help=optdict.get(\"hide\", False),\n95:             section=optdict.get(\"group\", None),\n96:             dest=optdict.get(\"dest\", None),\n97:         )\n98:     if \"kwargs\" in optdict:\n99:         if \"old_names\" in optdict[\"kwargs\"]:\n100:             return _StoreOldNamesArgument(\n101:                 flags=flags,\n102:                 default=default,\n103:                 arg_type=optdict[\"type\"],\n104:                 choices=optdict.get(\"choices\", None),\n105:                 arg_help=optdict.get(\"help\", \"\"),\n106:                 metavar=optdict.get(\"metavar\", \"\"),\n107:                 hide_help=optdict.get(\"hide\", False),\n108:                 kwargs=optdict.get(\"kwargs\", {}),\n109:                 section=optdict.get(\"group\", None),\n110:             )\n111:         if \"new_names\" in optdict[\"kwargs\"]:\n112:             return _StoreNewNamesArgument(\n113:                 flags=flags,\n114:                 default=default,\n115:                 arg_type=optdict[\"type\"],\n116:                 choices=optdict.get(\"choices\", None),\n117:                 arg_help=optdict.get(\"help\", \"\"),\n118:                 metavar=optdict.get(\"metavar\", \"\"),\n119:                 hide_help=optdict.get(\"hide\", False),\n120:                 kwargs=optdict.get(\"kwargs\", {}),\n121:                 section=optdict.get(\"group\", None),\n122:             )\n123:     if \"dest\" in optdict:\n124:         return _StoreOldNamesArgument(\n125:             flags=flags,\n126:             default=default,\n127:             arg_type=optdict[\"type\"],\n128:             choices=optdict.get(\"choices\", None),\n129:             arg_help=optdict.get(\"help\", \"\"),\n130:             metavar=optdict.get(\"metavar\", \"\"),\n131:             hide_help=optdict.get(\"hide\", False),\n132:             kwargs={\"old_names\": [optdict[\"dest\"]]},\n133:             section=optdict.get(\"group\", None),\n134:         )\n135:     return _StoreArgument(\n136:         flags=flags,\n137:         action=action,\n138:         default=default,\n139:         arg_type=optdict[\"type\"],\n140:         choices=optdict.get(\"choices\", None),\n141:         arg_help=optdict.get(\"help\", \"\"),\n142:         metavar=optdict.get(\"metavar\", \"\"),\n143:         hide_help=optdict.get(\"hide\", False),\n144:         section=optdict.get(\"group\", None),\n145:     )\n146: \n147: \n148: def _parse_rich_type_value(value: Any) -> str:\nCode replaced for brevity.\n156: \n157: \n158: \n159: # pylint: disable-next=unused-argument\n160: def _init_hook(run: Run, value: str | None) -> None:\nCode replaced for brevity.\n166: \n167: \n168: \n169: def _set_rcfile(run: Run, value: str | None) -> None:\nCode replaced for brevity.\n172: \n173: \n174: \n175: def _set_output(run: Run, value: str | None) -> None:\nCode replaced for brevity.\n178: \n179: \n180: \n181: def _add_plugins(run: Run, value: str | None) -> None:\nCode replaced for brevity.\n184: \n185: \n186: \n187: def _set_verbose_mode(run: Run, value: str | None) -> None:\nCode replaced for brevity.\n189: \n190: \n191: \n192: def _enable_all_extensions(run: Run, value: str | None) -> None:\nCode replaced for brevity.\n199: \n200: \n201: \n202: PREPROCESSABLE_OPTIONS: dict[\n203:     str, tuple[bool, Callable[[Run, str | None], None]]\n204: ] = {  # pylint: disable=consider-using-namedtuple-or-dataclass\n205:     \"--init-hook\": (True, _init_hook),\n206:     \"--rcfile\": (True, _set_rcfile),\n207:     \"--output\": (True, _set_output),\n208:     \"--load-plugins\": (True, _add_plugins),\n209:     \"--verbose\": (False, _set_verbose_mode),\n210:     \"--enable-all-extensions\": (False, _enable_all_extensions),\n211: }\n212: \n213: \n214: def _preprocess_options(run: Run, args: Sequence[str]) -> list[str]:\n215:     \"\"\"Preprocess options before full config parsing has started.\"\"\"\n216:     processed_args: list[str] = []\n217: \n218:     i = 0\n219:     while i < len(args):\n220:         argument = args[i]\n221:         if not argument.startswith(\"--\"):\n222:             processed_args.append(argument)\n223:             i += 1\n224:             continue\n225: \n226:         try:\n227:             option, value = argument.split(\"=\", 1)\n228:         except ValueError:\n229:             option, value = argument, None\n230: \n231:         if option not in PREPROCESSABLE_OPTIONS:\n232:             processed_args.append(argument)\n233:             i += 1\n234:             continue\n235: \n236:         takearg, cb = PREPROCESSABLE_OPTIONS[option]\n237: \n238:         if takearg and value is None:\n239:             i += 1\n240:             if i >= len(args) or args[i].startswith(\"-\"):\n... Code Truncated ...\n\n[start of pylint/lint/base_options.py]\n1: # Licensed under the GPL: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html\n2: # For details: https://github.com/PyCQA/pylint/blob/main/LICENSE\n3: # Copyright (c) https://github.com/PyCQA/pylint/blob/main/CONTRIBUTORS.txt\n4: \n5: \"\"\"Functions that creates the basic options for the Run and PyLinter classes.\"\"\"\n6: \n7: from __future__ import annotations\n8: \n9: import re\n10: import sys\n11: from typing import TYPE_CHECKING\n12: \n13: from pylint import interfaces\n14: from pylint.config.callback_actions import (\n15:     _DisableAction,\n16:     _DoNothingAction,\n17:     _EnableAction,\n18:     _ErrorsOnlyModeAction,\n19:     _FullDocumentationAction,\n20:     _GenerateConfigFileAction,\n21:     _GenerateRCFileAction,\n22:     _ListCheckGroupsAction,\n23:     _ListConfidenceLevelsAction,\n24:     _ListExtensionsAction,\n25:     _ListMessagesAction,\n26:     _ListMessagesEnabledAction,\n27:     _LongHelpAction,\n28:     _MessageHelpAction,\n29:     _OutputFormatAction,\n30: )\n31: from pylint.typing import Options\n32: \n33: if TYPE_CHECKING:\n34:     from pylint.lint import PyLinter, Run\n35: \n36: \n37: def _make_linter_options(linter: PyLinter) -> Options:\n38:     \"\"\"Return the options used in a PyLinter class.\"\"\"\n39:     return (\n40:         (\n41:             \"ignore\",\n42:             {\n43:                 \"type\": \"csv\",\n44:                 \"metavar\": \"<file>[,<file>...]\",\n45:                 \"dest\": \"black_list\",\n46:                 \"kwargs\": {\"old_names\": [\"black_list\"]},\n47:                 \"default\": (\"CVS\",),\n48:                 \"help\": \"Files or directories to be skipped. \"\n49:                 \"They should be base names, not paths.\",\n50:             },\n51:         ),\n... Code Truncated ...\n\n",
  "line_level_localization": [
    {
      "filename": "/pylint/config/argument.py",
      "suspect_lines": []
    },
    {
      "filename": "/pylint/config/arguments_manager.py",
      "suspect_lines": []
    },
    {
      "filename": "/pylint/config/utils.py",
      "suspect_lines": [
        221
      ]
    },
    {
      "filename": "/pylint/lint/base_options.py",
      "suspect_lines": []
    }
  ]
}
{
  "instance_id": "sympy__sympy-16886",
  "problem_statement": "Morse encoding for \"1\" is not correct\nThe current Morse mapping in simpy.crypto.crypto contains an incorrect mapping of \r\n`\"----\": \"1\"`   \r\n\r\nThe correct mapping is `\".----\": \"1\"`.\r\n\r\n\n",
  "localized_code": "[start of sympy/crypto/crypto.py]\n1: # -*- coding: utf-8 -*-\n2: \n3: \"\"\"\n4: This file contains some classical ciphers and routines\n5: implementing a linear-feedback shift register (LFSR)\n6: and the Diffie-Hellman key exchange.\n7: \n8: .. warning::\n9: \n10:    This module is intended for educational purposes only. Do not use the\n11:    functions in this module for real cryptographic applications. If you wish\n12:    to encrypt real data, we recommend using something like the `cryptography\n13:    <https://cryptography.io/en/latest/>`_ module.\n14: \n15: \"\"\"\n16: \n17: from __future__ import print_function\n18: \n19: from string import whitespace, ascii_uppercase as uppercase, printable\n20: \n21: from sympy import nextprime\n22: from sympy.core import Rational, Symbol\n23: from sympy.core.numbers import igcdex, mod_inverse\n24: from sympy.core.compatibility import range\n25: from sympy.matrices import Matrix\n26: from sympy.ntheory import isprime, totient, primitive_root\n27: from sympy.polys.domains import FF\n28: from sympy.polys.polytools import gcd, Poly\n29: from sympy.utilities.misc import filldedent, translate\n30: from sympy.utilities.iterables import uniq\n31: from sympy.utilities.randtest import _randrange, _randint\n32: from sympy.utilities.exceptions import SymPyDeprecationWarning\n33: \n34: \n35: def AZ(s=None):\n36:     \"\"\"Return the letters of ``s`` in uppercase. In case more than\n37:     one string is passed, each of them will be processed and a list\n38:     of upper case strings will be returned.\n39: \n40:     Examples\n41:     ========\n42: \n43:     >>> from sympy.crypto.crypto import AZ\n44:     >>> AZ('Hello, world!')\n45:     'HELLOWORLD'\n46:     >>> AZ('Hello, world!'.split())\n47:     ['HELLO', 'WORLD']\n48: \n49:     See Also\n50:     ========\n51:     check_and_join\n52:     \"\"\"\n53:     if not s:\n54:         return uppercase\n55:     t = type(s) is str\n56:     if t:\n57:         s = [s]\n58:     rv = [check_and_join(i.upper().split(), uppercase, filter=True)\n59:         for i in s]\n60:     if t:\n61:         return rv[0]\n62:     return rv\n63: \n64: bifid5 = AZ().replace('J', '')\n65: bifid6 = AZ() + '0123456789'\n66: bifid10 = printable\n67: \n68: \n69: def padded_key(key, symbols, filter=True):\nCode replaced for brevity.\n98: \n99: \n100: \n101: def check_and_join(phrase, symbols=None, filter=None):\nCode replaced for brevity.\n138: \n139: \n140: \n141: def _prep(msg, key, alp, default=None):\nCode replaced for brevity.\n153: \n154: \n155: \n156: def cycle_list(k, n):\nCode replaced for brevity.\n170: \n171: \n172: \n173: ######## shift cipher examples ############\n174: \n175: \n176: def encipher_shift(msg, key, symbols=None):\nCode replaced for brevity.\n234: \n235: \n236: \n237: def decipher_shift(msg, key, symbols=None):\nCode replaced for brevity.\n260: \n261: \n262: def encipher_rot13(msg, symbols=None):\nCode replaced for brevity.\n281: \n282: \n283: def decipher_rot13(msg, symbols=None):\nCode replaced for brevity.\n310: \n311: \n312: ######## affine cipher examples ############\n313: \n314: \n315: def encipher_affine(msg, key, symbols=None, _inverse=False):\nCode replaced for brevity.\n376: \n377: \n378: \n379: def decipher_affine(msg, key, symbols=None):\nCode replaced for brevity.\n399: \n400: \n401: def encipher_atbash(msg, symbols=None):\nCode replaced for brevity.\n420: \n421: \n422: def decipher_atbash(msg, symbols=None):\nCode replaced for brevity.\n447: \n448: \n449: #################### substitution cipher ###########################\n450: \n451: \n452: def encipher_substitution(msg, old, new=None):\nCode replaced for brevity.\n502: \n503: \n504: \n505: ######################################################################\n506: #################### Vigenère cipher examples ########################\n507: ######################################################################\n508: \n509:     \"\nCode replaced for brevity.\n674: \n675: \n676: \n677:     Dec\nCode replaced for brevity.\n697: \n698: \n699: \n700: #################### Hill cipher  ########################\n701: \n702: \n703:     Ret\nCode replaced for brevity.\n785: \n786: \n787: \n788:     Deci\nCode replaced for brevity.\n849: \n850: \n851: \n852: #################### Bifid cipher  ########################\n853: \n854: \n855:     Per\nCode replaced for brevity.\n900: \n901: \n902: \n903:     Per\nCode replaced for brevity.\n992: \n993: \n994: \n995:     \"\"\"Return ch\nCode replaced for brevity.\n1031: \n1032: \n1033: \n1034:     Per\nCode replaced for brevity.\n1126: \n1127: \n1128: \n1129:     Ret\nCode replaced for brevity.\n1165: \n1166: \n1167: \n1168:     5x5\nCode replaced for brevity.\n1192: \n1193: \n1194: \n1195:     Per\nCode replaced for brevity.\n1222: \n1223: \n1224: \n1225:     Per\nCode replaced for brevity.\n1259: \n1260: \n1261: \n1262:     6x6\nCode replaced for brevity.\n1288: \n1289: \n1290: \n1291: #################### RSA  #############################\n1292: \n1293: \n1294:     Ret\nCode replaced for brevity.\n1325: \n1326: \n1327: \n1328:     Ret\nCode replaced for brevity.\n1359: \n1360: \n1361: \n1362:     Retu\nCode replaced for brevity.\n1379: \n1380: \n1381: \n1382:     Retu\nCode replaced for brevity.\n1399: \n1400: \n1401: \n1402: #################### kid krypto (kid RSA) #############################\n1403: \n1404: \n1405:     Kid\nCode replaced for brevity.\n1438: \n1439: \n1440: \n1441:     Comp\nCode replaced for brevity.\n1460: \n1461: \n1462: \n1463:     Here\nCode replaced for brevity.\n1480: \n1481: \n1482: \n1483:     Here\nCode replaced for brevity.\n1504: \n1505: \n1506: \n1507: #################### Morse Code ######################################\n1508: \n1509: morse_char = {\n1510:     \".-\": \"A\", \"-...\": \"B\",\n1511:     \"-.-.\": \"C\", \"-..\": \"D\",\n1512:     \".\": \"E\", \"..-.\": \"F\",\n1513:     \"--.\": \"G\", \"....\": \"H\",\n1514:     \"..\": \"I\", \".---\": \"J\",\n1515:     \"-.-\": \"K\", \".-..\": \"L\",\n1516:     \"--\": \"M\", \"-.\": \"N\",\n1517:     \"---\": \"O\", \".--.\": \"P\",\n1518:     \"--.-\": \"Q\", \".-.\": \"R\",\n1519:     \"...\": \"S\", \"-\": \"T\",\n1520:     \"..-\": \"U\", \"...-\": \"V\",\n1521:     \".--\": \"W\", \"-..-\": \"X\",\n1522:     \"-.--\": \"Y\", \"--..\": \"Z\",\n1523:     \"-----\": \"0\", \"----\": \"1\",\n1524:     \"..---\": \"2\", \"...--\": \"3\",\n1525:     \"....-\": \"4\", \".....\": \"5\",\n1526:     \"-....\": \"6\", \"--...\": \"7\",\n1527:     \"---..\": \"8\", \"----.\": \"9\",\n1528:     \".-.-.-\": \".\", \"--..--\": \",\",\n1529:     \"---...\": \":\", \"-.-.-.\": \";\",\n1530:     \"..--..\": \"?\", \"-....-\": \"-\",\n1531:     \"..--.-\": \"_\", \"-.--.\": \"(\",\n1532:     \"-.--.-\": \")\", \".----.\": \"'\",\n1533:     \"-...-\": \"=\", \".-.-.\": \"+\",\n1534:     \"-..-.\": \"/\", \".--.-.\": \"@\",\n1535:     \"...-..-\": \"$\", \"-.-.--\": \"!\"}\n1536: char_morse = {v: k for k, v in morse_char.items()}\n1537: \n1538: \n1539:     Enco\nCode replaced for brevity.\n1583: \n1584: \n1585: \n1586:     Deco\nCode replaced for brevity.\n1617: \n1618: \n1619: \n1620: #################### LFSRs  ##########################################\n1621: \n1622: \n1623:     Thi\nCode replaced for brevity.\n1719: \n1720: \n1721: \n1722:     This\nCode replaced for brevity.\n1763: \n1764: \n1765: \n1766:     This\nCode replaced for brevity.\n1857: \n1858: \n1859: \n1860: #################### ElGamal  #############################\n1861: \n1862: \n1863:     Ret\nCode replaced for brevity.\n1906: \n1907: \n1908: \n1909:     Retu\nCode replaced for brevity.\n1931: \n1932: \n1933: \n1934:     Enc\nCode replaced for brevity.\n1984: \n1985: \n1986: \n1987:     Dec\nCode replaced for brevity.\n2023: \n2024: \n2025: \n2026: ################ Diffie-Hellman Key Exchange  #########################\n2027: \n2028:     Ret\nCode replaced for brevity.\n2086: \n2087: \n2088: \n2089:     Retu\nCode replaced for brevity.\n2118: \n2119: \n2120: \n2121:     Retu\nCode replaced for brevity.\n2158: \n2159: \n2160: \n2161: ################ Goldwasser-Micali Encryption  #########################\n2162: \n2163: \n2164:     Retu\nCode replaced for brevity.\n2191: \n2192: \n2193: \n2194:     randrange =\nCode replaced for brevity.\n2199: \n2200: \n2201: \n2202:     Chec\nCode replaced for brevity.\n2263: \n2264: \n2265: \n2266:     Comp\nCode replaced for brevity.\n2299: \n2300: \n2301: \n2302:     Encr\nCode replaced for brevity.\n2332: \n2333: \n2334: \n2335: \n2336:     Decr\nCode replaced for brevity.\n2358: \n2359: \n2360: ################ Blum–Goldwasser cryptosystem  #########################\n2361: \n2362:     Check\nCode replaced for brevity.\n2400: \n2401: \n2402:     Calculat\nCode replaced for brevity.\n2422: \n2423: \n2424:     Encrypts\nCode replaced for brevity.\n2478: \n2479: \n2480:     Decrypts\nCode replaced for brevity.\n2527: \n\n",
  "line_level_localization": [
    {
      "filename": "/sympy/crypto/crypto.py",
      "suspect_lines": [
        1523
      ]
    }
  ]
}
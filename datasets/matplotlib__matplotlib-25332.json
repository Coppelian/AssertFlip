{
  "instance_id": "matplotlib__matplotlib-25332",
  "problem_statement": "[Bug]: Unable to pickle figure with aligned labels\n### Bug summary\r\n\r\n Unable to pickle figure after calling `align_labels()`\r\n\r\n### Code for reproduction\r\n\r\n```python\r\nimport matplotlib.pyplot as plt\r\nimport pickle\r\n\r\nfig = plt.figure()\r\nax1 = fig.add_subplot(211)\r\nax2 = fig.add_subplot(212)\r\ntime=[0,1,2,3,4]\r\nspeed=[40000,4300,4500,4700,4800]\r\nacc=[10,11,12,13,14]\r\nax1.plot(time,speed)\r\nax1.set_ylabel('speed')\r\nax2.plot(time,acc)\r\nax2.set_ylabel('acc')\r\n\r\nfig.align_labels() ##pickling works after removing this line \r\n\r\npickle.dumps(fig)\r\nplt.show()\r\n```\r\n\r\n\r\n### Actual outcome\r\n```\r\nalign.py\", line 16\r\npickle.dumps(fig)\r\nTypeError: cannot pickle 'weakref.ReferenceType' object\r\n```\r\n### Expected outcome\r\n\r\nPickling successful\r\n\r\n### Additional information\r\n\r\n_No response_\r\n\r\n### Operating system\r\n\r\nWindows\r\n\r\n### Matplotlib Version\r\n\r\n3.7.0\r\n\r\n### Matplotlib Backend\r\n\r\n_No response_\r\n\r\n### Python version\r\n\r\n_No response_\r\n\r\n### Jupyter version\r\n\r\n_No response_\r\n\r\n### Installation\r\n\r\nNone\n",
  "localized_code": "[start of lib/matplotlib/cbook.py]\n1: \"\"\"\n2: A collection of utility functions and classes.  Originally, many\n3: (but not all) were from the Python Cookbook -- hence the name cbook.\n4: \"\"\"\n5: \n6: import collections\n7: import collections.abc\n8: import contextlib\n9: import functools\n10: import gzip\n11: import itertools\n12: import math\n13: import operator\n14: import os\n15: from pathlib import Path\n16: import shlex\n17: import subprocess\n18: import sys\n19: import time\n20: import traceback\n21: import types\n22: import weakref\n23: \n24: import numpy as np\n25: \n26: import matplotlib\n27: from matplotlib import _api, _c_internal_utils\n28: \n29: \n30: def _get_running_interactive_framework():\n31:     \"\"\"\n32:     Return the interactive framework whose event loop is currently running, if\n33:     any, or \"headless\" if no event loop can be started, or None.\n34: \n35:     Returns\n36:     -------\n37:     Optional[str]\n38:         One of the following values: \"qt\", \"gtk3\", \"gtk4\", \"wx\", \"tk\",\n39:         \"macosx\", \"headless\", ``None``.\n40:     \"\"\"\n41:     # Use ``sys.modules.get(name)`` rather than ``name in sys.modules`` as\n42:     # entries can also have been explicitly set to None.\n43:     QtWidgets = (\n44:         sys.modules.get(\"PyQt6.QtWidgets\")\n45:         or sys.modules.get(\"PySide6.QtWidgets\")\n46:         or sys.modules.get(\"PyQt5.QtWidgets\")\n47:         or sys.modules.get(\"PySide2.QtWidgets\")\n48:     )\n49:     if QtWidgets and QtWidgets.QApplication.instance():\n50:         return \"qt\"\n51:     Gtk = sys.modules.get(\"gi.repository.Gtk\")\n... Code Truncated ...\n\n",
  "line_level_localization": [
    {
      "filename": "/lib/matplotlib/cbook.py",
      "suspect_lines": []
    }
  ]
}
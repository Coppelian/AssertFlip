{
  "instance_id": "sympy__sympy-19040",
  "problem_statement": "Factor with extension=True drops a factor of y-1\nI guess this related (or a duplicate of?) #5786\r\n\r\nThis is from stackoverflow:\r\nhttps://stackoverflow.com/questions/60682765/python-sympy-factoring-polynomial-over-complex-numbers\r\n```julia\r\nIn [9]: z = expand((x-1)*(y-1))                                                                                                                \r\n\r\nIn [10]: z                                                                                                                                     \r\nOut[10]: x⋅y - x - y + 1\r\n\r\nIn [11]: factor(z)                                                                                                                             \r\nOut[11]: (x - 1)⋅(y - 1)\r\n\r\nIn [12]: factor(z, extension=[I])                                                                                                              \r\nOut[12]: x - 1\r\n```\nFactor with extension=True drops a factor of y-1\n<!-- Your title above should be a short description of what\r\nwas changed. Do not include the issue number in the title. -->\r\nFactor with extension=True drops a factor of y-1\r\n#### References to other Issues or PRs\r\n<!-- If this pull request fixes an issue, write \"Fixes #NNNN\" in that exact\r\nformat, e.g. \"Fixes #1234\" (see\r\nhttps://tinyurl.com/auto-closing for more information). Also, please\r\nwrite a comment on that issue linking back to this pull request once it is\r\nopen. -->\r\nFixes #18895 \r\n\r\n#### Brief description of what is fixed or changed\r\n\r\n\r\n#### Other comments\r\n\r\n\r\n#### Release Notes\r\n\r\n<!-- Write the release notes for this release below. See\r\nhttps://github.com/sympy/sympy/wiki/Writing-Release-Notes for more information\r\non how to write release notes. The bot will check your release notes\r\nautomatically to see if they are formatted correctly. -->\r\n\r\n<!-- BEGIN RELEASE NOTES -->\r\nNO ENTRY\r\n<!-- END RELEASE NOTES -->\n",
  "localized_code": "[start of sympy/polys/factortools.py]\n1: \"\"\"Polynomial factorization routines in characteristic zero. \"\"\"\n2: \n3: from __future__ import print_function, division\n4: \n5: from sympy.polys.galoistools import (\n6:     gf_from_int_poly, gf_to_int_poly,\n7:     gf_lshift, gf_add_mul, gf_mul,\n8:     gf_div, gf_rem,\n9:     gf_gcdex,\n10:     gf_sqf_p,\n11:     gf_factor_sqf, gf_factor)\n12: \n13: from sympy.polys.densebasic import (\n14:     dup_LC, dmp_LC, dmp_ground_LC,\n15:     dup_TC,\n16:     dup_convert, dmp_convert,\n17:     dup_degree, dmp_degree,\n18:     dmp_degree_in, dmp_degree_list,\n19:     dmp_from_dict,\n20:     dmp_zero_p,\n21:     dmp_one,\n22:     dmp_nest, dmp_raise,\n23:     dup_strip,\n24:     dmp_ground,\n25:     dup_inflate,\n26:     dmp_exclude, dmp_include,\n27:     dmp_inject, dmp_eject,\n28:     dup_terms_gcd, dmp_terms_gcd)\n29: \n30: from sympy.polys.densearith import (\n31:     dup_neg, dmp_neg,\n32:     dup_add, dmp_add,\n33:     dup_sub, dmp_sub,\n34:     dup_mul, dmp_mul,\n35:     dup_sqr,\n36:     dmp_pow,\n37:     dup_div, dmp_div,\n38:     dup_quo, dmp_quo,\n39:     dmp_expand,\n40:     dmp_add_mul,\n41:     dup_sub_mul, dmp_sub_mul,\n42:     dup_lshift,\n43:     dup_max_norm, dmp_max_norm,\n44:     dup_l1_norm,\n45:     dup_mul_ground, dmp_mul_ground,\n46:     dup_quo_ground, dmp_quo_ground)\n47: \n48: from sympy.polys.densetools import (\n49:     dup_clear_denoms, dmp_clear_denoms,\n50:     dup_trunc, dmp_ground_trunc,\n51:     dup_content,\n52:     dup_monic, dmp_ground_monic,\n53:     dup_primitive, dmp_ground_primitive,\n54:     dmp_eval_tail,\n55:     dmp_eval_in, dmp_diff_eval_in,\n56:     dmp_compose,\n57:     dup_shift, dup_mirror)\n58: \n59: from sympy.polys.euclidtools import (\n60:     dmp_primitive,\n61:     dup_inner_gcd, dmp_inner_gcd)\n62: \n63: from sympy.polys.sqfreetools import (\n64:     dup_sqf_p,\n65:     dup_sqf_norm, dmp_sqf_norm,\n66:     dup_sqf_part, dmp_sqf_part)\n67: \n68: from sympy.polys.polyutils import _sort_factors\n69: from sympy.polys.polyconfig import query\n70: \n71: from sympy.polys.polyerrors import (\n72:     ExtraneousFactors, DomainError, CoercionFailed, EvaluationFailed)\n73: \n74: from sympy.ntheory import nextprime, isprime, factorint\n75: from sympy.utilities import subsets\n76: \n77: from math import ceil as _ceil, log as _log\n78: \n79: \n80: def dup_trial_division(f, factors, K):\nCode replaced for brevity.\n100: \n101: \n102: \n103: def dmp_trial_division(f, factors, u, K):\nCode replaced for brevity.\n123: \n124: \n125: \n126: def dup_zz_mignotte_bound(f, K):\nCode replaced for brevity.\n132: \n133: \n134: \n135: def dmp_zz_mignotte_bound(f, u, K):\nCode replaced for brevity.\n141: \n142: \n143: \n144: def dup_zz_hensel_step(m, f, g, h, s, t, K):\nCode replaced for brevity.\n198: \n199: \n200: \n201: def dup_zz_hensel_lift(p, f, f_list, l, K):\nCode replaced for brevity.\n256: \n257: \n258: def _test_pl(fc, q, pl):\nCode replaced for brevity.\n263: \n264: \n265: def dup_zz_zassenhaus(f, K):\nCode replaced for brevity.\n365: \n366: \n367: \n368: def dup_zz_irreducible_p(f, K):\nCode replaced for brevity.\n380: \n381: \n382: \n383: def dup_cyclotomic_p(f, K, irreducible=False):\nCode replaced for brevity.\n456: \n457: \n458: \n459: def dup_zz_cyclotomic_poly(n, K):\nCode replaced for brevity.\n467: \n468: \n469: \n470: def _dup_cyclotomic_decompose(n, K):\nCode replaced for brevity.\n481: \n482: \n483: \n484: def dup_zz_cyclotomic_factor(f, K):\nCode replaced for brevity.\n525: \n526: \n527: \n528: def dup_zz_factor_sqf(f, K):\nCode replaced for brevity.\n554: \n555: \n556: \n557: def dup_zz_factor(f, K):\nCode replaced for brevity.\n629: \n630: \n631: \n632: def dmp_zz_wang_non_divisors(E, cs, ct, K):\nCode replaced for brevity.\n649: \n650: \n651: \n652: def dmp_zz_wang_test_points(f, T, ct, A, u, K):\nCode replaced for brevity.\n675: \n676: \n677: \n678: def dmp_zz_wang_lead_coeffs(f, T, cs, E, H, A, u, K):\nCode replaced for brevity.\n729: \n730: \n731: \n732: def dup_zz_diophantine(F, m, p, K):\nCode replaced for brevity.\n777: \n778: \n779: \n780: def dmp_zz_diophantine(F, c, A, d, p, u, K):\nCode replaced for brevity.\n845: \n846: \n847: \n848: def dmp_zz_wang_hensel_lifting(f, H, LC, A, p, u, K):\nCode replaced for brevity.\n897: \n898: \n899: \n900: def dmp_zz_wang(f, u, K, mod=None, seed=None):\nCode replaced for brevity.\n1039: \n1040: \n1041: \n1042: def dmp_zz_factor(f, u, K):\nCode replaced for brevity.\n1104: \n1105: \n1106: \n1107: def dup_ext_factor(f, K):\nCode replaced for brevity.\n1135: \n1136: \n1137: \n1138: def dmp_ext_factor(f, u, K):\n1139:     \"\"\"Factor multivariate polynomials over algebraic number fields. \"\"\"\n1140:     if not u:\n1141:         return dup_ext_factor(f, K)\n1142: \n1143:     lc = dmp_ground_LC(f, u, K)\n1144:     f = dmp_ground_monic(f, u, K)\n1145: \n1146:     if all(d <= 0 for d in dmp_degree_list(f, u)):\n1147:         return lc, []\n1148: \n1149:     f, F = dmp_sqf_part(f, u, K), f\n1150:     s, g, r = dmp_sqf_norm(f, u, K)\n1151: \n1152:     factors = dmp_factor_list_include(r, u, K.dom)\n1153: \n1154:     if len(factors) == 1:\n1155:         factors = [f]\n1156:     else:\n1157:         H = dmp_raise([K.one, s*K.unit], u, 0, K)\n1158: \n1159:         for i, (factor, _) in enumerate(factors):\n1160:             h = dmp_convert(factor, u, K.dom, K)\n1161:             h, _, g = dmp_inner_gcd(h, g, u, K)\n1162:             h = dmp_compose(h, H, u, K)\n1163:             factors[i] = h\n1164: \n1165:     return lc, dmp_trial_division(F, factors, u, K)\n1166: \n1167: \n1168: def dup_gf_factor(f, K):\nCode replaced for brevity.\n1177: \n1178: \n1179: \n1180: def dmp_gf_factor(f, u, K):\nCode replaced for brevity.\n1182: \n1183: \n1184: \n1185: def dup_factor_list(f, K0):\nCode replaced for brevity.\n1244: \n1245: \n1246: \n1247: def dup_factor_list_include(f, K):\nCode replaced for brevity.\n1255: \n1256: \n1257: \n1258: def dmp_factor_list(f, u, K0):\nCode replaced for brevity.\n1328: \n1329: \n1330: \n1331: def dmp_factor_list_include(f, u, K):\nCode replaced for brevity.\n1342: \n1343: \n1344: \n1345: def dup_irreducible_p(f, K):\nCode replaced for brevity.\n1350: \n1351: \n1352: \n1353: def dmp_irreducible_p(f, u, K):\nCode replaced for brevity.\n1366: \n\n",
  "line_level_localization": [
    {
      "filename": "/sympy/polys/factortools.py",
      "suspect_lines": [
        1150
      ]
    }
  ]
}
{
  "instance_id": "django__django-11880",
  "problem_statement": "Form Field’s __deepcopy__ does not (deep)copy the error messages.\nDescription\n\t\nThe __deepcopy__ method defined for the formfields (​https://github.com/django/django/blob/146086f219d01dbb1cd8c089b5a5667e396e1cc4/django/forms/fields.py#L200) performs a shallow copy of self and does not include additional treatment for the error_messages dictionary. As a result, all copies of the same field share the same dictionary and any modification of either the dictionary or the error message itself for one formfield is immediately reflected on all other formfiels.\nThis is relevant for Forms and ModelForms that modify the error messages of their fields dynamically: while each instance of the specific form (e.g., ProfileForm) is expected to have a set of fields “sealed” away from other instances of the same ProfileForm (​https://github.com/django/django/blob/146086f219d01dbb1cd8c089b5a5667e396e1cc4/django/forms/forms.py#L95), in fact all these instances share the same error messages, resulting in incorrectly raised errors.\nConfirmed for versions of Django going back to 1.11.\n",
  "localized_code": "[start of django/forms/fields.py]\n1: \"\"\"\n2: Field classes.\n3: \"\"\"\n4: \n5: import copy\n6: import datetime\n7: import math\n8: import operator\n9: import os\n10: import re\n11: import uuid\n12: from decimal import Decimal, DecimalException\n13: from io import BytesIO\n14: from urllib.parse import urlsplit, urlunsplit\n15: \n16: from django.core import validators\n17: from django.core.exceptions import ValidationError\n18: from django.forms.boundfield import BoundField\n19: from django.forms.utils import from_current_timezone, to_current_timezone\n20: from django.forms.widgets import (\n21:     FILE_INPUT_CONTRADICTION, CheckboxInput, ClearableFileInput, DateInput,\n22:     DateTimeInput, EmailInput, FileInput, HiddenInput, MultipleHiddenInput,\n23:     NullBooleanSelect, NumberInput, Select, SelectMultiple,\n24:     SplitDateTimeWidget, SplitHiddenDateTimeWidget, TextInput, TimeInput,\n25:     URLInput,\n26: )\n27: from django.utils import formats\n28: from django.utils.dateparse import parse_duration\n29: from django.utils.duration import duration_string\n30: from django.utils.ipv6 import clean_ipv6_address\n31: from django.utils.translation import gettext_lazy as _, ngettext_lazy\n32: \n33: __all__ = (\n34:     'Field', 'CharField', 'IntegerField',\n35:     'DateField', 'TimeField', 'DateTimeField', 'DurationField',\n36:     'RegexField', 'EmailField', 'FileField', 'ImageField', 'URLField',\n37:     'BooleanField', 'NullBooleanField', 'ChoiceField', 'MultipleChoiceField',\n38:     'ComboField', 'MultiValueField', 'FloatField', 'DecimalField',\n39:     'SplitDateTimeField', 'GenericIPAddressField', 'FilePathField',\n40:     'SlugField', 'TypedChoiceField', 'TypedMultipleChoiceField', 'UUIDField',\n41: )\n42: \n43: \n44: class Field:\n45:     widget = TextInput  # Default widget to use when rendering this type of Field.\n46:     hidden_widget = HiddenInput  # Default widget to use when rendering this as \"hidden\".\n47:     default_validators = []  # Default set of validators\n48:     # Add an 'invalid' entry to default_error_message if you want a specific\n49:     # field error message not raised by the field validators.\n50:     default_error_messages = {\n51:         'required': _('This field is required.'),\n... Code Truncated ...\n\n",
  "line_level_localization": [
    {
      "filename": "/django/forms/fields.py",
      "suspect_lines": []
    }
  ]
}
{
  "instance_id": "django__django-13279",
  "problem_statement": "Session data cannot be decoded during the transition to Django 3.1.\nDescription\n\t\nIn d4fff711d4c97356bd6ba1273d2a5e349326eb5f (#31274) we've changed format for session data, that's why setting DEFAULT_HASHING_ALGORITHM to 'sha1' is not enough to support running multiple instances of the same project during the transition to Django 3.1.\nWe could use the legacy encode() when DEFAULT_HASHING_ALGORITHM == 'sha1' (it's a bit hacky).\n",
  "localized_code": "[start of django/contrib/sessions/backends/base.py]\n1: import base64\n2: import logging\n3: import string\n4: import warnings\n5: from datetime import datetime, timedelta\n6: \n7: from django.conf import settings\n8: from django.contrib.sessions.exceptions import SuspiciousSession\n9: from django.core import signing\n10: from django.core.exceptions import SuspiciousOperation\n11: from django.utils import timezone\n12: from django.utils.crypto import (\n13:     constant_time_compare, get_random_string, salted_hmac,\n14: )\n15: from django.utils.deprecation import RemovedInDjango40Warning\n16: from django.utils.module_loading import import_string\n17: from django.utils.translation import LANGUAGE_SESSION_KEY\n18: \n19: # session_key should not be case sensitive because some backends can store it\n20: # on case insensitive file systems.\n21: VALID_KEY_CHARS = string.ascii_lowercase + string.digits\n22: \n23: \n24: class CreateError(Exception):\n25:     \"\"\"\n26:     Used internally as a consistent exception type to catch from save (see the\n27:     docstring for SessionBase.save() for details).\n28:     \"\"\"\n29:     pass\n30: \n31: \n32: class UpdateError(Exception):\n33:     \"\"\"\n34:     Occurs if Django tries to update a session that was deleted.\n35:     \"\"\"\n36:     pass\n37: \n38: \n39: class SessionBase:\n40:     \"\"\"\n41:     Base class for all Session classes.\n42:     \"\"\"\n43:     TEST_COOKIE_NAME = 'testcookie'\n44:     TEST_COOKIE_VALUE = 'worked'\n45: \n46:     __not_given = object()\n47: \n48:     def __init__(self, session_key=None):\n49:         self._session_key = session_key\n50:         self.accessed = False\n51:         self.modified = False\n... Code Truncated ...\n\n",
  "line_level_localization": [
    {
      "filename": "/django/contrib/sessions/backends/base.py",
      "suspect_lines": []
    }
  ]
}
{
  "instance_id": "sphinx-doc__sphinx-8721",
  "problem_statement": "viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`\n**Describe the bug**\r\nviewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`\r\n\r\n**To Reproduce**\r\n```\r\n$ make html epub\r\n```\r\n\r\n**Expected behavior**\r\nmodule pages should not be created for epub by default.\r\n\r\n**Your project**\r\nNo\r\n\r\n**Screenshots**\r\nNo\r\n\r\n**Environment info**\r\n- OS: Mac\r\n- Python version: 3.9.1\r\n- Sphinx version: HEAD of 3.x\r\n- Sphinx extensions:  sphinx.ext.viewcode\r\n- Extra tools: No\r\n\r\n**Additional context**\r\nNo\r\n\n",
  "localized_code": "[start of sphinx/ext/viewcode.py]\n1: \"\"\"\n2:     sphinx.ext.viewcode\n3:     ~~~~~~~~~~~~~~~~~~~\n4: \n5:     Add links to module code in Python object descriptions.\n6: \n7:     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\n8:     :license: BSD, see LICENSE for details.\n9: \"\"\"\n10: \n11: import posixpath\n12: import traceback\n13: from os import path\n14: from typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\n15: \n16: from docutils import nodes\n17: from docutils.nodes import Element, Node\n18: \n19: import sphinx\n20: from sphinx import addnodes\n21: from sphinx.application import Sphinx\n22: from sphinx.builders.html import StandaloneHTMLBuilder\n23: from sphinx.environment import BuildEnvironment\n24: from sphinx.locale import _, __\n25: from sphinx.pycode import ModuleAnalyzer\n26: from sphinx.util import get_full_modname, logging, status_iterator\n27: from sphinx.util.nodes import make_refnode\n28: \n29: logger = logging.getLogger(__name__)\n30: \n31: \n32: OUTPUT_DIRNAME = '_modules'\n33: \n34: \n35: def _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\n36:     try:\n37:         return get_full_modname(modname, attribute)\n38:     except AttributeError:\n39:         # sphinx.ext.viewcode can't follow class instance attribute\n40:         # then AttributeError logging output only verbose mode.\n41:         logger.verbose('Didn\\'t find %s in %s', attribute, modname)\n42:         return None\n43:     except Exception as e:\n44:         # sphinx.ext.viewcode follow python domain directives.\n45:         # because of that, if there are no real modules exists that specified\n46:         # by py:function or other directives, viewcode emits a lot of warnings.\n47:         # It should be displayed only verbose mode.\n48:         logger.verbose(traceback.format_exc().rstrip())\n49:         logger.verbose('viewcode can\\'t import %s, failed with error \"%s\"', modname, e)\n50:         return None\n51: \n... Code Truncated ...\n\n",
  "line_level_localization": [
    {
      "filename": "/sphinx/ext/viewcode.py",
      "suspect_lines": []
    }
  ]
}